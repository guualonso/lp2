<ui:composition
  template="/WEB-INF/template/LayoutPadrao.xhtml"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:p="http://primefaces.org/ui">

  <ui:define name="titulo">Disciplina</ui:define>

  <ui:define name="corpo">
    <h:form id="formulario">

      <h1>Disciplinas</h1>

      <p:growl id="growl" showDetail="false" />

      <p:toolbar style="margin-top: 20px">
        <p:toolbarGroup>
          <p:commandButton icon="pi pi-plus" value="Novo" 
                           oncomplete="PF('editarDialogWidgetVar').show()" 
                           update="editarDialog" process="@this" />
        </p:toolbarGroup>
      </p:toolbar>

      <p:dataTable id="disciplinasTable" var="disciplina" 
                   value="#{manterDisciplinaBean.disciplinas}" 
                   lazy="false" showGridlines="true"
                   style="margin-top: 20px" emptyMessage="Nenhuma disciplina cadastrada." 
                   rows="10" paginator="true" paginatorAlwaysVisible="true" 
                   paginatorPosition="bottom" rowsPerPageTemplate="5,10,15">

        <p:column headerText="Id" style="width: 40px; text-align: center">
          <h:outputText value="#{disciplina.id}" />
        </p:column>

        <p:column headerText="Nome" style="width: 350px; text-align: left" 
                  filterBy="#{disciplina.nome}">
          <h:outputText value="#{disciplina.nome}" />
        </p:column>

        <p:column headerText="Operações" style="width: 40px; text-align: center">
          <p:commandButton icon="pi pi-pencil" title="Editar"
                           oncomplete="PF('editarDialogWidgetVar').show()"
                           update=":formulario:editarDialog" process="@this">
            <f:setPropertyActionListener target="#{manterDisciplinaBean.disciplina}" 
                                         value="#{disciplina}" />
          </p:commandButton>

          <p:commandButton icon="pi pi-trash" title="Excluir"
                           onclick="PF('confirmacaoExclusao').show();" process="@this">
            <f:setPropertyActionListener target="#{manterDisciplinaBean.disciplina}" 
                                         value="#{disciplina}" />
          </p:commandButton>
        </p:column>

      </p:dataTable>

      <p:dialog id="editarDialog" header="Disciplina" widgetVar="editarDialogWidgetVar"
                modal="true" resizable="true" closeOnEscape="true"
                showEffect="explode" hideEffect="explode" 
                width="50%" position="center top" maximizable="true"
                height="50%" fitViewport="true" responsive="true">

        <p:panelGrid id="grid" columns="2">

          <p:outputLabel for="id" value="Id: " />
          <p:outputLabel id="id" value="#{manterDisciplinaBean.disciplina.id}" />

          <p:outputLabel for="nome" value="Nome: " />
          <p:inputText id="nome" value="#{manterDisciplinaBean.disciplina.nome}" />

          <p:commandButton icon="pi pi-save" id="salvarButton"
                           value="Salvar" title="Grava dados da Disciplina"
                           actionListener="#{manterDisciplinaBean.salvar}"
                           oncomplete="if (!args.validationFailed) PF('editarDialogWidgetVar').hide()"
                           update="growl disciplinasTable" process="@this grid">
          </p:commandButton>

        </p:panelGrid>
      </p:dialog>

      <p:confirmDialog id="confirmacaoExclusaoDialog" widgetVar="confirmacaoExclusao"
                       message="Tem certeza que deseja excluir a disciplina #{manterDisciplinaBean.disciplina.nome}?"
                       header="Exclusão de disciplina" severity="alert">
        <p:button icon="pi pi-thumbs-down" value="Não"
                  onclick="PF('confirmacaoExclusao').hide(); return false;" process="@this"/>
        <p:commandButton icon="pi pi-thumbs-up" value="Sim" 
                         update=":formulario:disciplinasTable"
                         onclick="PF('confirmacaoExclusao').hide();"
                         action="#{manterDisciplinaBean.excluir}" process="@this"/>
      </p:confirmDialog>

    </h:form>
  </ui:define>
</ui:composition>
